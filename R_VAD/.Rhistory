# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd.smooth), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
source("helpfun.R")
source("helpfun.R")
source("helpfun.R")
vad_20160114n <- lowess.vad(vad_20160114n)
dataframe <- vad_20160114n
vad.dt <- as.data.table(dataframe)
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = span, delta = delta)$y, by = ht]
dataframe <- vad_20160114n
span = 0.06
delta = 0
vad.dt <- as.data.table(dataframe)
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = span, delta = delta)$y, by = ht]
source("helpfun.R")
vad_20160114n <- lowess.vad(vad_20160114n)
dia <- vad_20160114n
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
source("geom_arrow.R")
source("helpfun.R")
vad_20170120 <- read.vad("../../20170120_240/vda*")
dia <- vad_20170120
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170120 <- lowess.vad(vad_20170120)
dia <- vad_20170120
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
source("geom_arrow.R")
source("helpfun.R")
vad_20160114 <- read.vad("../../20160114_240/vda*")
vad_20170120 <- read.vad("../../20170120_240/vda*")
vad_20160116 <- read.vad("../../20160116_240/vda*")
vad_20160114 <- lowess.vad(vad_20160114)
vad_20160116 <- lowess.vad(vad_20160116)
vad_20170120 <- lowess.vad(vad_20170120)
dia <- vad_20160116
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(perfiles, aes(ht, spd, color = as.factor(hour(date_time)))) +
geom_line() +
coord_flip() +
scale_color_brewer(palette = "Set1", name="Tiempo", type = "qual") +
ylab("Viento (m/s)") +
xlab("Altura (Km)") +
labs(title = paste0("Perfiles de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(perfiles, aes(u, v,  color = as.factor(hour(date_time)))) +
geom_point(data=subset(perfiles, ht != 0.1), size = 1) +
geom_point(data=subset(perfiles, ht == 0.1), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Hora", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]))) +
xlim(c(-10,14)) +
ylim(c(-10,14)) +
coord_equal() +
theme_minimal()
ggplot(perfiles, aes(u, v,  color = as.factor(hour(date_time)))) +
geom_point(data=subset(perfiles, ht != 0.1), size = 1) +
geom_point(data=subset(perfiles, ht == 0.1), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Hora", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]))) +
#xlim(c(-10,14)) +
#ylim(c(-10,14)) +
coord_equal() +
theme_minimal()
ggplot(subset(tiempos, ht %in% c(0.3, 1.0)), aes(u, v,  color = as.factor(ht))) +
geom_point(aes(x = ifelse(hour(date_time) != 0, u, NA)), size = 1) +
geom_point(aes(x = ifelse(hour(date_time) == 0, u, NA)), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Nivel", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]), "para distintos niveles")) +
xlim(c(-12,10)) +
ylim(c(-14,10)) +
coord_equal() +
theme_minimal()
ggplot(subset(tiempos, ht %in% c(0.3, 1.0)), aes(u, v,  color = as.factor(ht))) +
geom_point(aes(x = ifelse(hour(date_time) != 0, u, NA)), size = 1) +
geom_point(aes(x = ifelse(hour(date_time) == 0, u, NA)), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Nivel", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]), "para distintos niveles")) +
#xlim(c(-12,10)) +
#ylim(c(-14,10)) +
coord_equal() +
theme_minimal()
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
View(sup)
sup$intensidad <- sup$intensidad * 0.5144
sup$direccion <- sup$direccion * 10 #Paso del formato synop a angulos entre 0 y 360
sup$ht <- 0.01
View(vad_20160114)
sup$date_time <- as.Date(paste(sup$fecha, sup$hora.utc, sep = "."), format = "%y/%m/%d.%h")
vad_20160114$date_time[1]
sup$date_time <- as.Date(paste(sup$fecha, sup$hora.utc, sep = "."), format = "%y-%m-%d.%h")
str(sup)
sup$fecha <- as.Date(sup$fecha)
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
sup$fecha <- as.Date(sup$fecha, format = "%y%m%d")
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
sup$fecha <- ymd(sup$fecha)
sup$fecha <- as.Date(sup$fecha)
sup$fecha <- ymd(sup$fecha)
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
sup$fecha <- as.numeric(sup$fecha)
sup$fecha <- ymd(sup$fecha)
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
sup$fecha <- as.numeric(sup$fecha)
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
str(sup)
sup$fecha <- dmy(sup$fecha)
sup$hora.utc <- hm(sup$hora.utc)
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
sup$hora.utc <- h(sup$hora.utc)
sup$hora.utc <- hms(sup$hora.utc)
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
sup$hora.utc <- h(sup$hora.utc)
sup$hora.utc <- hm(paste0(sup$hora.utc, ":00"))
str(sup)
sup <- read.csv("../../Superficie/parana2016.csv", sep = ";", na.strings = " ")
# Ahora hay que trabajar sobre el archivo para que las variable de interés estén en las unidades
# que corresponden y tengan el nivel correspondiente
sup$intensidad <- sup$intensidad * 0.5144 # Paso de nudos a m/s
sup$direccion <- sup$direccion * 10 #Paso del formato synop a angulos entre 0 y 360
sup$ht <- 0.01
# Ahora la fecha y hora, miedo.
sup$fecha <- dmy_hm(paste0(sup$fecha, " - ", sup$hora.utc, ":00"))
keep <- c("fecha", "ht", "direccion", "intensidad")
sup[keep]
keep <- c("fecha", "ht", "direccion", "intensidad")
sup <- sup[keep]
source('~/Dropbox/Tesis/tesis-VAD/R_VAD/helpfun.R', echo=TRUE)
vad_20160114 <- read.vad("../../20160114_240/vda*")
size(vad_20160114)
dim(vad_20160114)
sup$u <- sup$intensidad * cos(sup$direccion*pi/180)
sup$v <- sup$intensidad * sin(sup$direccion*pi/180)
cnames <- c("X", "ht", "spd", "rmse1", "rmse2", "rmse3", "di", "rings", "date_time", "u", "v")
str(vad_20160114)
superficie <- data.frame(X = integer(), ht = sup$ht)
superficie <- data.frame(X = NA, ht = sup$ht)
superficie <- data.frame(X = NA,
ht = sup$ht,
spd = sup$intensidad,
rmse1 = NA,
rmse2 = NA,
rmse3 = NA,
di = sup$direccion,
rings = NA,
date_time = sup$fecha,
u = sup$u,
v = sup$v)
View(superficie)
vad_20160114$date_time <- ymd_hm(vad_20160114$date_time)
vad_20160114 <- read.vad("../../20160114_240/vda*")
vad_20160114 <- lowess.vad(vad_20160114)
vad_20160114$date_time[1]
round_date(vad_20160114$date_time[1], unit = "second")
round_date(vad_20160114$date_time[1], unit = "minute")
round_date(vad_20160114$date_time[1], unit = c("year", "month", "day", "hour", "minute"))
round_date(vad_20160114$date_time[20], unit = "minute")
round_date(vad_20160114$date_time[30], unit = "minute")
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
source("geom_arrow.R")
source("helpfun.R")
vad_20170121 <- read.vad("../../20170121_240/vda*")
vad_20170121 <- lowess.vad(vad_20170121)
dia <- vad_20170121
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170127 <- read.vad("../../20170127_240/vda*")
vad_20170127 <- lowess.vad(vad_20170127)
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
dia <- vad_20170127
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170128 <- read.vad("../../20170128_240/vda*")
vad_20170128 <- lowess.vad(vad_20170128)
dia <- vad_20170128
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170129 <- read.vad("../../20170129_240/vda*")
vad_20170129 <- lowess.vad(vad_20170129)
vad_20170129 <- lowess.vad(vad_20170129)
dia <- vad_20170129
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20160123 <- read.vad("../../20160123_240/vda*")
vad_20160123 <- lowess.vad(vad_20160123)
dia <- vad_20160123
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20160123 <- read.vad("../../20160123_240/vda*")
dia <- vad_20160123
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20160123 <- lowess.vad(vad_20160123)
dia <- vad_20160123
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
source("geom_arrow.R")
source("helpfun.R")
vad_20160122 <- read.vad("../../20160122_240/vda*")
vad_20160113 <- read.vad("../../20160113_240/vda*")
vad_20160122 <- lowess.vad(vad_20160122)
vad_20160113 <- lowess.vad(vad_20160113)
dia <- vad_20160122
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20160122 <- read.vad("../../20160122_240/vda*")
dia <- vad_20160122
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
dia <- vad_20160113
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
dia <- merge(vad_20160113, vad_20160114)
View(dia)
View(vad_20160113)
dia <- rbind(vad_20160113, vad_20160114)
View(dia)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ncdf4)
ncfile <- nc_open("datos/temp.nc")
setwd("~/Dropbox/Elio&Pao reload/atmosfeRa/1 Encuentro/encuentroR2")
ncfile <- nc_open("datos/temp.nc")
lon <- ncvar_get(ncfile, "lon")
lat <- ncvar_get(ncfile, "lat")
lev <- ncvar_get(ncfile, "level")
time <- ncvar_get(ncfile, "time")
time <- ymd_hms("1800-01-01 00:00:00") + hours(time)    # esto es gracias a lubridate
t <- ncvar_get(ncfile, "air")
library(lubridate)
time <- ymd_hms("1800-01-01 00:00:00") + hours(time)    # esto es gracias a lubridate
dimnames(t) <- list(lon = lon, lat = lat, lev = lev, date = as.character(time))
library(reshape2)
t <- melt(t)
ggplot(subset(t, date == date[1] & lev == lev[1]), aes(lon, lat)) +
geom_tile(aes(fill = value))      # grafico los datos
library(ggplot2)
ggplot(subset(t, date == date[1] & lev == lev[1]), aes(lon, lat)) +
geom_tile(aes(fill = value))      # grafico los datos
world <- map_data("world2")
g <- ggplot(subset(t, date == date[1] & lev == lev[1]), aes(lon, lat)) +
geom_contour(aes(z = value, color = ..level..)) +
geom_path(data = world,
aes(long, lat, group = group),
size = 0.2)
g <- g + scale_color_gradient2(low = "blue", high = "red")
g + coord_map(projection = "mollweide")
install.packages("mapproj")
