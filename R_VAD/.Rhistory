tbl_df() %>%
mutate(spd.smooth = loess(spd ~ date_time, span = 0.2))
vad_20170120 %>%
group_by(ht) %>%
tbl_df() %>%
mutate(spd.smooth = spd)
library(data.tablee)
library(data.table)
vad.dt <- as.data.table(vad_20170120)
vad.dt[, spd.smooth := loess(spd ~ date_time, span = 0.2)$fitted,
by = ht]
vad.dt[, spd.smooth := loess(spd ~ seq_along(spd), span = 0.2)$fitted,
by = ht]
warnings(9)
with(vad.dt[ht == 0.2], loess(spd ~ seq_along(spd), span = 0.2)$fitted)
vad.dt[ht == 0.2]
vad.dt[ht == 0.2 & !is.na(spd)]
with(vad.dt[ht == 0.2], predict(loess(spd ~ seq_along(spd), span = 0.2)))
with(vad.dt[ht == 0.2], predict(loess(spd ~ seq_along(date_time), span = 0.2)))
with(vad.dt[ht == 0.2], predict(loess(spd ~ date_time, span = 0.2)))
with(vad.dt[ht == 0.2], predict(loess(spd ~ I(as.numeric(date_time)), span = 0.2)))
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.2)$y,
by = ht]
warnings()
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.2, evaluation = .N)$y,
by = ht]
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.2, evaluation = .N)$y,
by = ht]
warnings()
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth)) +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 01, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.1, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.15, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth))
ggplot(vad.dt, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..)) +
geom_contour(aes(z = spd, color = ..level..)) +
test <- vad_20170120 %>%
group_by(ht) %>%
filter(ht == 1.8) %>%
mutate(spd.input = approx(date_time, spd, xout = date_time)$y)
ggplot(vad.dt, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..)) +
geom_contour(aes(z = spd, color = ..level..))
ggplot(vad.dt, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), linetype = 2) +
geom_contour(aes(z = spd, color = ..level..))
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.12, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), linetype = 2) +
geom_contour(aes(z = spd, color = ..level..))
install.packages("devtools")
devtools::install_github("eliocamp/meteoR")
install.packages("maps")
devtools::install_github("eliocamp/meteoR")
ggplot(vad.dt, aes(date_time, ht)) +
meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd, color = ..level..), linetype = 2)
ggplot(vad.dt, aes(date_time, ht)) +
meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd, color = ..level..))
vad_20170120 %>%
group_by(ht) %>%
tbl_df() %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = .N)$y)
vad_20170120 %>%
group_by(ht) %>%
tbl_df() %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = 50)$y)
vad_20170120 %>%
group_by(ht) %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = 50)$y)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.12, evaluation = length(spd))$y,
by = ht]
vad_20170120 %>%
group_by(ht) %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = length(spd))$y)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.12, evaluation = .N)$y,
by = ht]
vad.dt <- as.data.table(vad_20170120)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.12, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
vad_20170120 %>%
group_by(ht) %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = length(spd))$y)
ggplot(vad_20170120, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
vad.dt <- as.data.table(vad_20170120)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.12, evaluation = .N)$y,
by = ht]
ggplot(vad, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time, ht)) +
meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd, color = ..level..))
vad.dt[, na.acum := cumsum(is.na(spd)), by = ht]
vad.dt
install.packages("zo")
install.packages("zoo")
vad.dt[, na.acum := zoo::rollapply(sdp, width = 6, function(x) is.na(x)), by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
vad.dt <- as.data.table(vad_20170120)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.12, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
vad.dt
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
geom_point(aes(size = na.acum)) +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
geom_point(aes(y = 1, size = na.acum)) +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time, ht)) +
meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd, color = ..level..))
ggplot(vad.dt[na.acum < 3], aes(date_time, ht)) +
meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd, color = ..level..))
ggplot(vad.dt, aes(date_time, ht)) +
meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_tile(fill = "white", data = vad.dt[na.acum >= 3]) +
geom_contour(aes(z = spd, color = ..level..))
ggplot(vad.dt, aes(date_time, ht)) +
meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..))
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd.smooth))
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum < 4, spd.smooth, NA)))
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum < 5, spd.smooth, NA)))
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)))
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA))) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..))
vad.dt[, conf := na.acu <= 4]
vad.dt[, conf := na.acum <= 4]
group_by(vad_20170120, ht) %>%
mutate(dv = c(NA, NA, diff(diff(spd)))) %>%
mutate(dvs = as.numeric(scale(dv))) %>%
ggplot(aes(date_time, spd)) +
geom_line() + #geom_smooth(span = 0.2) +
facet_wrap(~ht, scales = "free_y")
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
geom_point(aes(y = 1, size = na.acum)) +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
geom_col(aes(y = na.acum)) +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht)
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
theme_bw()
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
theme_minimal()
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA))) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..))
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..))
ggplot(vad.dt, aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red", binwidth = 1) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 1, direction = 1) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 2, direction = 1) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 4, direction = 1) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 5, direction = 1) +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
source("geom_arrow.R")
source("helpfun.R")
vad_20160114 <- read.vad("../../20160114_240/vda*")
dia <- vad_20160114
vad.dt <- as.data.table(vad_20160114)
library(data.table)
vad.dt <- as.data.table(vad_20160114)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.12, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.10, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.05, evaluation = .N)$y,
by = ht]
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.08, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.t[, .N, by = ht]
vad.dt[, .N, by = ht]
139/3
3/139
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.06, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red") +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..)) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red", binwidth = 2) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 2) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.065, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 5, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse >0.5, rmse, NA)), type = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse >0.5, rmse, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.06, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
