scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
geom_arrow(data =  tiempos1, aes(mag = spd, angle = di, color = spd)) +
geom_arrow(aes(mag = spd, angle = di, color = spd))
tiempos1 <- subset(vad_20160114, minute(date_time) == 0)
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
geom_arrow(data =  tiempos1, aes(mag = spd, angle = di, color = spd)) +
geom_arrow(aes(mag = spd, angle = di, color = spd))
tiempos1 <- subset(vad_20160114, minute(date_time) == 0 & !is.na(spd))
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
geom_arrow(data =  tiempos1, aes(mag = spd, angle = di, color = spd)) +
geom_arrow(aes(mag = spd, angle = di, color = spd))
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd))
vad_20160114n <- read.vad("../../20160114_240/vda*")
dia <- vad_20160114n
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd))
vad_20160114n <- read.vad("../../20160114_240/vda*")
dia <- vad_20160114n
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd))
vad_20160114n <- read.vad("../../20160114_240/vda*")
dia <- vad_20160114n
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170120 %>%
group_by(ht) %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = length(spd))$y)
library(dplyr)
vad_20170120 %>%
group_by(ht) %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = length(spd))$y)
vad.dt <- as.data.table(vad_20160114n)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.06, evaluation = .N)$y,
by = ht]
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.1, evaluation = .N)$y,
by = ht]
View(vad_20160114n)
vad.dt <- as.data.table(vad_20160114n)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.1, evaluation = .N)$y,
by = ht]
vad_20160114n %>%
group_by(ht) %>%
mutate(spd.smooth = loess.smooth(date_time, spd, span = 0.12, evaluation = length(spd))$y)
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.1, evaluation = .N)$y,
by = ht]
class(vad.dt)
warnings()
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.06, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := loess(spd ~ date_time, span = 0.06, evaluation = .N)$y,
by = ht]
vad.dt <- as.data.table(vad_20160114n)
vad.dt[, spd.smooth := loess(spd ~ date_time, span = 0.06, evaluation = .N)$y,
by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
vad.dt[, spd.smooth := loess(spd ~ date_time, span = 0.06, evaluation = .N)$y,
by = ht]
vad.dt[, spd.smooth := loess(spd ~ date_time, span = 0.75, evaluation = .N)$y,
by = ht]
spd <- loess(spd ~ date_time, span = 0.75)
spd <- loess(spd ~ date_time, , data = vad_20160114n, span = 0.75)
spd <- loess.smooth(spd ~ date_time, , data = vad_20160114n, span = 0.75)
spd <- loess(spd ~ date_time,data = vad_20160114n, span = 0.75)
spd <- loess.smooth(date_time, spd, data = vad_20160114n, span = 0.75)
spd <- loess.smooth(vad_20160114n$date_time, vad_20160114n$spd, span = 0.75)
spd
spd <- loess(vad_20160114n$date_time, vad_20160114n$spd, span = 0.75)
spd <- loess(vad_20160114n$spd ~ vad_20160114n$date_time, span = 0.75)
spd <- lowess(vad_20160114n$spd ~ vad_20160114n$date_time, span = 0.75)
spd <- lowess(vad_20160114n$spd ~ vad_20160114n$date_time)
spd
str(spd)
vad.dt <- as.data.table(vad_20160114n)
vad.dt[, spd.smooth := lowess(spd ~ date_time)$y, by = ht]
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.1)$y, by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.06)$y, by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.05)$y, by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
144*0.06
144*0.02
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.03)$y, by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.05)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
#geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.06)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
#geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.06, delta delta = 0)$y, by = ht]
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.06, delta = 0)$y, by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := loess(spd ~ as.numeric(date_time), span = 0.75, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
vad.dt[, spd.smooth := loess(spd ~ as.numeric(date_time), span = 0.06, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
vad.dt[, spd.smooth := loess(spd ~ as.numeric(date_time), span = 0.06, evaluation = .N,
na.action = na.exclude)$y, by = ht]
vad.dt[, spd.smooth := loess(spd ~ as.numeric(date_time), span = 0.1, evaluation = .N,
na.action = na.exclude)$y, by = ht]
vad.dt[, spd.smooth := loess(spd ~ as.numeric(date_time), span = 0.2, evaluation = .N,
na.action = na.exclude)$y, by = ht]
vad.dt[, spd.smooth := loess(spd ~ as.numeric(date_time), span = 0.75, evaluation = .N,
na.action = na.exclude)$y, by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
vad.dt[, spd.smooth := loess.smooth(date_time, spd, span = 0.06, evaluation = .N)$y,
by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
dataframe <- vad_20170120
vad.dt <- as.data.table(dataframe)
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.06)$y, by = ht]
ggplot(vad.dt, aes(date_time)) +
geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
vad.dt[, na.acum := zoo::rollsum(is.na(spd), k = 6, fill = NA), by = ht]
ggplot(vad.dt, aes(date_time)) +
#geom_col(aes(y = na.acum)) +
geom_line(aes(y = spd)) +
geom_line(aes(y = spd.smooth), color = "red") +
facet_wrap(~ht) +
ylab("Velocidad (m/s)") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.06, delta = 0)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.1, delta = 0)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.7, delta = 0)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt <- as.data.table(dataframe)
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.7, delta = 0)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.07, delta = 0)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = ifelse(na.acum <= 4, spd.smooth, NA)), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd.smooth), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.06, delta = 0)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd.smooth), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = 0.05, delta = 0)$y, by = ht]
ggplot(subset(vad.dt, ht < 2.0), aes(date_time, ht)) +
# meteoR::stat_contour_fill(aes( z = spd.smooth)) +
geom_contour(aes(z = spd.smooth), color = "red", binwidth = 1) +
scale_colour_gradient(name = "Velocidad", low = "grey", high = "black") +
# geom_tile(fill = "white", data = vad.dt[na.acum >= 5]) +
geom_contour(aes(z = spd, color = ..level..), binwidth = 1) +
geom_point(aes(size = ifelse(rmse2 >0.5, rmse2, NA)), shape = 1) +
ylab("Altura (Km)") +
xlab("Tiempo") +
theme_minimal()
source("helpfun.R")
source("helpfun.R")
source("helpfun.R")
vad_20160114n <- lowess.vad(vad_20160114n)
dataframe <- vad_20160114n
vad.dt <- as.data.table(dataframe)
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = span, delta = delta)$y, by = ht]
dataframe <- vad_20160114n
span = 0.06
delta = 0
vad.dt <- as.data.table(dataframe)
vad.dt[, spd.smooth := lowess(spd ~ date_time, f = span, delta = delta)$y, by = ht]
source("helpfun.R")
vad_20160114n <- lowess.vad(vad_20160114n)
dia <- vad_20160114n
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
source("geom_arrow.R")
source("helpfun.R")
vad_20170120 <- read.vad("../../20170120_240/vda*")
dia <- vad_20170120
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170120 <- lowess.vad(vad_20170120)
dia <- vad_20170120
perfiles <- subset(dia, ht < 1.5 & minute(date_time) == 00 & hour(date_time) %in% c(0, 6, 12, 18, 23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd.smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
