load("~/Dropbox/Tesis/tesis-VAD/R_VAD/.RData")
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
vad_20160115 <- read.vad("../../20160115_240/vda*")
source("helpfun.R")
source('~/Dropbox/Tesis/tesis-VAD/R_VAD/helpfun.R', echo=TRUE)
read.vad <- function(path){
filename <- (Sys.glob(path))
datetime <- ymd_hms(stringi::stri_sub(filename, from = 24, to = 44))
for (i in 1:length(filename)){
temp <- read.csv(filename[i], sep = ";", dec = ".", na.strings = "-9999")
date_time <- datetime[i]
temp$date_time <- date_time
if (i == 1){
temp2 <- temp
} else {
temp2 <- rbind(temp2, temp)
}
}
temp2 <- lowess.vad(temp2)
temp2$di <- temp2$di
temp2$u <- -temp2$spd_smooth * sin(temp2$di*pi/180)
temp2$v <- -temp2$spd_smooth * cos(temp2$di*pi/180)
return(temp2)
}
vad_20160115 <- read.vad("../../20160115_240/vda*")
vad_20160115 <- read.vad("../../20160115_240/vda*")
View(read.vad)
filename <- (Sys.glob("../../20160115_240/vda*"))
datetime <- ymd_hms(stringi::stri_sub(filename, from = 24, to = 44))
datetime <- ymd_hms(stringi::stri_sub(filename, from = 24, to = 44))
datetime <- ymd_hms(stringi::stri_sub(filename, from = 23, to = 43))
filename
setwd("~/Dropbox/Tesis/tesis-VAD/R_VAD")
vad_20160115 <- read.vad("../../20160115_240/vda*")
dia <- vad_20160115
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggsave(paste0("Campo_", as.Date(dia$date_time[1]), ".png"), device = "png", path = "fig")
ggplot(perfiles, aes(ht, spd, color = as.factor(hour(date_time)))) +
geom_line() +
coord_flip() +
scale_color_brewer(palette = "Set1", name="Tiempo", type = "qual") +
ylab("Viento (m/s)") +
xlab("Altura (Km)") +
labs(title = paste0("Perfiles de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggsave(paste0("Dirección_", as.Date(dia$date_time[1]), ".png"), device = "png", path = "fig")
ggplot(perfiles, aes(u, v,  color = as.factor(hour(date_time)))) +
geom_point(data=subset(perfiles, ht != 0.1), size = 1) +
geom_point(data=subset(perfiles, ht == 0.1), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Hora", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]), "en distintos tiempos")) +
#xlim(c(-10,14)) +
#ylim(c(-10,14)) +
coord_equal() +
theme_minimal()
ggplot(subset(tiempos, ht %in% c(0.01, 0.3, 1.0)), aes(u, v,  color = as.factor(ht))) +
geom_point(aes(x = ifelse(hour(date_time) != 0, u, NA)), size = 1) +
geom_point(aes(x = ifelse(hour(date_time) == 0, u, NA)), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Nivel", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]), "para distintos niveles")) +
#xlim(c(-12,10)) +
#ylim(c(-14,10)) +
coord_equal() +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
vad_20160114 <- read.vad("../../20160114_240/vda*") #%>% lowess.vad()
dia <- vad_20160114
perfiles <- subset(dia, ht < 1.0 & minute(date_time) == 00 & hour(date_time) %in% c(20,21,22,23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggsave(paste0("Campo_", as.Date(dia$date_time[1]), ".png"), device = "png", path = "fig")
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
dia <- vad_20160114
perfiles <- subset(dia, ht < 1.0 & minute(date_time) == 00 & hour(date_time) %in% c(20,21,22,23))
tiempos <- subset(dia, minute(date_time) == 0)
ggplot(perfiles, aes(u, v,  color = as.factor(hour(date_time)))) +
geom_point(data=subset(perfiles, ht != 0.1), size = 1) +
geom_point(data=subset(perfiles, ht == 0.1), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Hora", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]), "en distintos tiempos")) +
#xlim(c(-10,14)) +
#ylim(c(-10,14)) +
coord_equal() +
theme_minimal()
perfiles <- subset(dia, ht < 1.0 & minute(date_time) == 00 & hour(date_time) %in% c(03,09,12,15,18,21))
ggplot(perfiles, aes(u, v,  color = as.factor(hour(date_time)))) +
geom_point(data=subset(perfiles, ht != 0.1), size = 1) +
geom_point(data=subset(perfiles, ht == 0.1), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Hora", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]), "en distintos tiempos")) +
#xlim(c(-10,14)) +
#ylim(c(-10,14)) +
coord_equal() +
theme_minimal()
perfiles <- subset(dia, ht < 1.0 & minute(date_time) == 00 & hour(date_time) %in% c(03,06,09,12,15,18,21))
ggplot(perfiles, aes(u, v,  color = as.factor(hour(date_time)))) +
geom_point(data=subset(perfiles, ht != 0.1), size = 1) +
geom_point(data=subset(perfiles, ht == 0.1), shape = 17, size = 3) +
geom_path() +
scale_color_brewer(palette = "Set1", name="Hora", type = "qual") +
xlab("u (m/s)") + ylab("v (m/s)") +
labs(title = paste0("Hodógrafa para el ", as.Date(dia$date_time[1]), "en distintos tiempos")) +
#xlim(c(-10,14)) +
#ylim(c(-10,14)) +
coord_equal() +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
vad_20160113 <- read.vad("../../20160113_240/vda*") #%>% lowess.vad()
dia <- vad_20160113
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
dia <- rbind(vad_20160113, vad_20160114)
dia <- rbind(vad_20160113, vad_20160114)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
dia <- rbind(vad_20160122, vad_20160123)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20160122 <- read.vad("../../20160122_240/vda*")
vad_20160123 <- read.vad("../../20160123_240/vda*")
dia <- rbind(vad_20160122, vad_20160123)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170120 <- read.vad("../../20170120_240/vda*")
vad_20170121 <- read.vad("../../20170121_240/vda*")
dia <- rbind(vad_20170120, vad_20170121)
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
vad_20170129 <- read.vad("../../20170129_240/vda*")
dia <- vad_20170129
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170127 <- read.vad("../../2017012_240/vda*")
vad_20170127 <- read.vad("../../20170127_240/vda*")
dia <- vad_20170127
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170128 <- read.vad("../../20170128_240/vda*")
dia <- vad_20170128
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
dia <- vad_20170120
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20170120 <- read.vad("../../20170120_240/vda*")
vad_20170121 <- read.vad("../../20170121_240/vda*")
dia <- vad_20170120
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggsave(paste0("Campo_", as.Date(dia$date_time[1]), ".png"), device = "png", path = "fig")
dia <- vad_20170121
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
ggsave(paste0("Campo_", as.Date(dia$date_time[1]), ".png"), device = "png", path = "fig")
dia <- vad_20160114
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20160107 <- read.vad("../../20160107_240/vda*")
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
vad_20160107 <- read.vad("../../20160107_240/vda*")
dia <- vad_20160107
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
vad_20160107 <- read.vad("../../20160107_240/vda*")
dia <- vad_20160107
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
View(vad_20160114)
ggplot(subset(tiempos, !is.na(spd)), aes(date_time, ht)) +
#geom_arrow(data =  tiempos1, aes(mag = spd, angle = di), color = "red") +
geom_arrow(aes(mag = spd, angle = di, color = spd)) +
geom_point(aes(size = ifelse(rmse1 > 0.5, rmse1, NA)), shape = 1, color = "black") +
geom_point(aes(size = ifelse(rmse2 > 0.5, rmse2, NA)), shape = 4, color = "grey25") +
scale_size_continuous(range = c(0, 5), guide = "none") +
scale_color_distiller(palette = "Oranges", name="Velocidad", direction = 1) +
xlab("Tiempo (hora UTC)") + ylab("Altura (km)") +
ylim(c(0,2)) +
scale_x_datetime(date_breaks = "2 hour", date_labels = "%H z") +
theme(axis.text.x = element_text(angle = 45)) +
labs(title = paste0("Dirección del viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
dia <- vad_20160114
72/360
30/360
vad_20160109 <- read.vad("../../20160109_240/vda*")
library(ggplot2)
library(reshape2)
library(lubridate)
library(RadioSonde)
library(gridBase)
library(grid)
library(magrittr)
library(data.table)
library(zoo)
library(dplyr)
library(mutate)
source("geom_arrow.R")
source("helpfun.R")
vad_20160109 <- read.vad("../../20160109_240/vda*")
dia <- vad_20160109
ggplot(dia, aes(date_time, ht)) +
geom_contour(aes(z = spd_smooth, color = ..level..), binwidth = 1) +
# geom_contour(data = vad_20160114, aes(z = spd)) +
scale_color_distiller(name = "Velocidad", type = "seq", palette = 8, direction = 1) +
geom_point(data = subset(dia, rmse1 > 0.5), aes(size = rmse1), shape = 1, color = "black") +
geom_point(data = subset(dia, rmse2 > 0.5), aes(size = rmse2), shape = 4, color = "grey25") +
ylim(c(0,2)) + xlab("Tiempo") +
ylab("Altura (km)") +
labs(title = paste0("Campo de viento para el ", as.Date(dia$date_time[1]))) +
theme_minimal()
